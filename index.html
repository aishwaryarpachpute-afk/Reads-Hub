<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Reads Hub</title>
  <meta name="description" content="Reads Hub — discover popular books, login, and checkout." />
  <style>
    /* ---------- Reset & base ---------- */
    :root{
      --bg: #0f1724;
      --card: #0b1220;
      --muted: #9aa4b2;
      --accent: #6ee7b7;
      --accent-2:#60a5fa;
      --glass: rgba(15, 14, 14, 0.04);
      --glass-2: rgba(255,255,255,0.02);
      --radius: 12px;
      --maxw: 1100px;
      font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      color-scheme: dark;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      padding:32px;
      background:
        radial-gradient(1000px 400px at 10% 10%, rgba(96,165,250,0.06), transparent 10%),
        radial-gradient(800px 300px at 90% 90%, rgba(110,231,183,0.03), transparent 10%),
        linear-gradient(180deg, #031021 0%, #071323 100%);
      color:#e6eef6;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      display:flex;
      justify-content:center;
      align-items:flex-start;
      gap:24px;
    }

    .container{
      width:100%;
      max-width:var(--maxw);
      background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border-radius:16px;
      padding:20px;
      box-shadow: 0 6px 30px rgba(2,6,23,0.6);
      border: 1px solid rgba(255,255,255,0.03);
    }

    header {
      display:flex;
      justify-content:space-between;
      gap:16px;
      align-items:center;
      margin-bottom:18px;
    }

    .brand {
      display:flex;
      align-items:center;
      gap:12px;
    }

    .logo {
      width:56px;
      height:56px;
      border-radius:12px;
      background: linear-gradient(135deg,var(--accent),var(--accent-2));
      display:flex;
      align-items:center;
      justify-content:center;
      font-weight:700;
      color:#052022;
      font-size:20px;
      box-shadow: 0 6px 18px rgba(99,102,241,0.08), inset 0 -4px 8px rgba(255,255,255,0.06);
    }
    h1 { margin:0; font-size:20px; letter-spacing:0.2px; }
    p.lead { margin:0; color:var(--muted); font-size:13px }

    nav {
      display:flex;
      gap:10px;
      align-items:center;
    }
    .nav-btn {
      background:transparent;
      border:1px solid rgba(255,255,255,0.03);
      padding:8px 12px;
      border-radius:10px;
      color:var(--muted);
      font-size:14px;
      cursor:pointer;
    }
    .nav-btn.primary {
      background:linear-gradient(90deg,var(--accent),var(--accent-2));
      color:#052022;
      border:none;
      font-weight:600;
    }

    /* ---------- layout ---------- */
    .main-grid{
      display:grid;
      grid-template-columns: 300px 1fr;
      gap:20px;
    }

    aside {
      background:var(--glass);
      border-radius:12px;
      padding:16px;
      min-height:400px;
      border:1px solid rgba(255,255,255,0.02);
    }
    .search {
      display:flex;
      gap:8px;
      margin-bottom:12px;
    }
    .search input{
      flex:1;
      background:transparent;
      border:1px solid rgba(255,255,255,0.04);
      padding:8px 10px;
      border-radius:8px;
      color:inherit;
    }
    .category-list {
      margin-top:10px;
      display:flex;
      flex-direction:column;
      gap:8px;
    }
    .category-btn {
      background:transparent;
      border:1px dashed rgba(255,255,255,0.03);
      padding:8px 10px;
      border-radius:8px;
      color:var(--muted);
      text-align:left;
      cursor:pointer;
      font-size:14px;
    }
    .category-btn.active {
      background:linear-gradient(90deg, rgba(96,165,250,0.12), rgba(110,231,183,0.06));
      color:var(--accent-2);
      border:1px solid rgba(96,165,250,0.12);
      font-weight:600;
    }

    /* book grid */
    .content {
      min-height:600px;
    }
    .books-grid {
      display:grid;
      grid-template-columns: repeat(auto-fill, minmax(200px,1fr));
      gap:16px;
    }

    .card {
      background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border-radius:12px;
      padding:12px;
      border:1px solid rgba(255,255,255,0.02);
      display:flex;
      gap:12px;
      align-items:flex-start;
      transition:transform .16s ease, box-shadow .16s ease;
    }
    .card:hover { transform:translateY(-6px); box-shadow:0 12px 30px rgba(2,6,23,0.6) }

    .cover {
      width:72px;
      height:100px;
      border-radius:6px;
      flex-shrink:0;
      overflow:hidden;
      background:linear-gradient(180deg, rgba(0,0,0,0.25), rgba(255,255,255,0.02));
      box-shadow: inset 0 -6px 18px rgba(0,0,0,0.25);
    }
    .cover img { width:100%; height:100%; object-fit:cover; display:block; }

    .meta { flex:1 }
    .title { margin:0; font-size:15px; line-height:1.15; }
    .author { margin:6px 0 0 0; color:var(--muted); font-size:13px }
    .tags { margin-top:8px; display:flex; gap:6px; flex-wrap:wrap }
    .tag { font-size:12px; padding:6px 8px; border-radius:999px; background:var(--glass-2); color:var(--muted) }

    .card-actions { display:flex; gap:8px; margin-top:10px; }
    .btn { padding:8px 10px; border-radius:8px; border:none; cursor:pointer; font-weight:600; font-size:13px; }
    .btn.ghost { background:transparent; color:var(--accent-2); border:1px solid rgba(96,165,250,0.12) }
    .btn.buy { background:linear-gradient(90deg,var(--accent),var(--accent-2)); color:#052022 }

    /* pages (account/payment/contact) */
    .page {
      display:none;
      background:var(--glass);
      border-radius:12px;
      padding:16px;
      border:1px solid rgba(255,255,255,0.02);
    }
    .page.active { display:block }

    .account-grid { display:grid; grid-template-columns: 1fr 320px; gap:12px }
    .profile-card {
      padding:16px;
      border-radius:12px;
      background:linear-gradient(180deg,rgba(255,255,255,0.01),transparent);
      border:1px solid rgba(255,255,255,0.02);
    }

    /* forms */
    label { display:block; font-size:13px; color:var(--muted); margin-bottom:6px }
    input[type=text], input[type=email], input[type=password], input[type=number], textarea, select {
      width:100%;
      padding:10px;
      border-radius:8px;
      border:1px solid rgba(255,255,255,0.03);
      background:transparent;
      color:inherit;
      font-size:14px;
    }
    textarea { min-height:120px; resize:vertical; }

    .form-row { display:flex; gap:8px }
    .small { flex:1 }

    footer { margin-top:18px; color:var(--muted); font-size:13px; text-align:center }

    /* modal */
    .modal {
      position:fixed;
      inset:0;
      display:none;
      align-items:center;
      justify-content:center;
      z-index:999;
      background:linear-gradient(0deg, rgba(2,6,23,0.6), rgba(2,6,23,0.6));
    }
    .modal.open { display:flex }
    .modal-card{
      width:420px;
      max-width:94%;
      background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      padding:18px;
      border-radius:12px;
      border:1px solid rgba(255,255,255,0.03);
    }

    .grid-2 { display:grid; grid-template-columns:1fr 1fr; gap:8px }
    .muted { color:var(--muted) }

    @media (max-width:980px){
      .main-grid { grid-template-columns: 1fr; }
      aside { order:2 }
    }

    /* tiny helpers */
    .right { display:flex; gap:8px; align-items:center }
    .hidden { display:none !important }

  </style>
</head>
<body>
  <div class="container" role="main">
    <header>
      <div class="brand">
        <div class="logo" aria-hidden>RH</div>
        <div>
          <h1>Reads Hub</h1>
          <p class="lead">Discover & buy your next favorite book</p>
        </div>
      </div>

      <nav aria-label="Main navigation">
        <button class="nav-btn" data-nav="home">Home</button>
        <button class="nav-btn" data-nav="account">Account</button>
        <button class="nav-btn" data-nav="payment">Payment</button>
        <button class="nav-btn" data-nav="contact">Contact</button>
        <button id="loginBtn" class="nav-btn primary">Login / Signup</button>
      </nav>
    </header>

    <div class="main-grid">
      <!-- SIDEBAR -->
      <aside aria-label="Filters">
        <div class="search" role="search">
          <input id="searchInput" placeholder="Search books or author..." aria-label="Search books" />
          <button class="nav-btn" id="clearSearch">Clear</button>
        </div>

        <div>
          <strong style="display:block; margin-bottom:8px">Categories</strong>
          <div class="category-list" id="categoryList">
            <!-- categories injected -->
          </div>
        </div>

        <div style="margin-top:16px">
          <strong style="display:block; margin-bottom:8px">Quick Links</strong>
          <div style="display:flex; flex-direction:column; gap:8px">
            <button class="category-btn" onclick="showPage('home')">All Books</button>
            <button class="category-btn" onclick="document.getElementById('loginBtn').click()">Login / Signup</button>
            <button class="category-btn" onclick="showPage('contact')">Contact Us</button>
          </div>
        </div>

        <div style="margin-top:18px; color:var(--muted); font-size:13px">
        </div>
      </aside>

      <!-- CONTENT -->
      <section class="content">
        <!-- HOME (books) -->
        <div id="home" class="page active" aria-live="polite">
          <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:12px;">
            <div>
              <h2 style="margin:0">Books</h2>
              <div class="muted" id="resultsInfo">Showing all books</div>
            </div>
            <div class="right">
              <select id="sortSelect" aria-label="Sort books">
                <option value="title">Sort: Title</option>
                <option value="author">Sort: Author</option>
              </select>
            </div>
          </div>

          <div class="books-grid" id="booksGrid" aria-live="polite">
            <!-- cards injected -->
          </div>
        </div>

        <!-- ACCOUNT -->
        <div id="account" class="page">
          <h2 style="margin-top:0">Account</h2>
          <div class="account-grid">
            <div>
              <div class="profile-card">
                <h3 id="accName">Guest</h3>
                <p class="muted" id="accEmail">Not logged in</p>
                <div style="margin-top:12px">
                  <button class="btn ghost" id="editProfileBtn">Edit Profile</button>
                  <button class="btn" id="logoutBtn">Logout</button>
                </div>
              </div>

              <div style="margin-top:12px" id="myLibraryCard" class="profile-card">
                <h4 style="margin:0 0 8px 0">My Library</h4>
                <div id="myLibraryList" class="muted">No purchases yet.</div>
              </div>
            </div>

            <aside class="profile-card">
              <h4 style="margin-top:0">Profile Settings</h4>
              <form id="profileForm">
                <label for="profileName">Name</label>
                <input id="profileName" type="text" placeholder="Your name" />

                <label for="profileEmail" style="margin-top:8px">Email</label>
                <input id="profileEmail" type="email" placeholder="you@example.com" />

                <div style="margin-top:8px">
                  <button class="btn" type="submit">Save</button>
                </div>
              </form>
            </aside>
          </div>
        </div>

        <!-- PAYMENT -->
        <div id="payment" class="page">
          <h2 style="margin-top:0">Payment </h2>
          <div style="display:grid; grid-template-columns: 1fr 340px; gap:12px; align-items:start">
            <div>
              <form id="paymentForm">
                <label>Selected item</label>
                <input id="paymentItem" type="text" readonly />

                <label style="margin-top:8px">Name on card</label>
                <input id="cardName" type="text" placeholder="Full name" />

                <div class="form-row" style="margin-top:8px">
                  <div class="small">
                    <label>Card number</label>
                    <input id="cardNumber" type="text" maxlength="19" placeholder="4242 4242 4242 4242" />
                  </div>
                  <div style="width:120px">
                    <label>Expiry (MM/YY)</label>
                    <input id="cardExp" type="text" maxlength="5" placeholder="12/34" />
                  </div>
                </div>

                <div class="form-row" style="margin-top:8px">
                  <div class="small">
                    <label>CVV</label>
                    <input id="cardCvv" type="text" maxlength="4" placeholder="123" />
                  </div>
                  <div style="width:140px">
                    <label>Amount (INR)</label>
                    <input id="cardAmt" type="number" step="0.01" value="9.99" />
                  </div>
                </div>

                <div style="margin-top:12px">
                  <button class="btn buy" id="payNowBtn" type="button">Pay now </button>
                </div>
              </form>

              <div id="paymentMsg" class="muted" style="margin-top:12px"></div>
            </div>

            <aside style="background:var(--glass); border-radius:12px; padding:12px; border:1px solid rgba(255,255,255,0.02)">
              <h4 style="margin-top:0">Order summary</h4>
              <div style="display:flex; justify-content:space-between; margin-top:8px">
                <div class="muted">Item</div>
                <div id="summaryItem">—</div>
              </div>
              <div style="display:flex; justify-content:space-between; margin-top:6px">
                <div class="muted">Price</div>
                <div id="summaryPrice">₹0.00</div>
              </div>

              <hr style="margin:12px 0; border:none; border-top:1px solid rgba(255,255,255,0.02)" />
              <div style="display:flex; justify-content:space-between; font-weight:700">
                <div>Total</div>
                <div id="summaryTotal">₹0.00</div>
              </div>
            </aside>
          </div>
        </div>

        <!-- CONTACT -->
        <div id="contact" class="page">
          <h2 style="margin-top:0">Contact Us</h2>
          <div style="display:grid; grid-template-columns:1fr 320px; gap:12px">
            <div>
              <form id="contactForm">
                <label>Name</label>
                <input id="contactName" type="text" placeholder="Your name" />

                <label style="margin-top:8px">Email</label>
                <input id="contactEmail" type="email" placeholder="you@example.com" />

                <label style="margin-top:8px">Message</label>
                <textarea id="contactMessage" placeholder="How can we help?"></textarea>

                <div style="margin-top:10px">
                  <button class="btn" type="submit">Send message</button>
                </div>
              </form>

              <div id="contactMsg" class="muted" style="margin-top:10px"></div>
            </div>

            <aside style="background:var(--glass); border-radius:12px; padding:12px; border:1px solid rgba(255,255,255,0.02)">
              <h4 style="margin-top:0">Contact details</h4>
              <div class="muted" style="margin-top:8px">
                Email: supportreadshub@gmail.com<br/>
                Address : Audyogik Tantra Shikshan Sanstha , Chinchwad
              </div>
            </aside>
          </div>
        </div>

        <footer>
          © <span id="year"></span> Reads Hub — All payments and logins are <b>Secure</b> to your browser.
        </footer>
      </section>
    </div>
  </div>

  <!-- LOGIN MODAL -->
  <div id="loginModal" class="modal" role="dialog" aria-modal="true" aria-labelledby="loginTitle">
    <div class="modal-card">
      <h3 id="loginTitle">Login / Signup</h3>
      <p class="muted" style="margin-top:6px"><b><h5>Enter a name and email to sign up. This  stores data in your browser only.</h5></b></p>

      <form id="loginForm" style="margin-top:12px">
        <label for="loginName"><B>Name</B></label>
        <input id="loginName" required type="text" placeholder="Your name" />

        <label for="loginEmail" style="margin-top:8px"><b>Email</b></label>
        <input id="loginEmail" required type="email" placeholder="you@example.com" />

        <div style="margin-top:10px; display:flex; gap:8px; justify-content:flex-end">
          <button type="button" class="nav-btn" id="loginCancel">Cancel</button>
          <button type="submit" class="btn primary" style="background:linear-gradient(90deg,var(--accent),var(--accent-2)); color:#052022">Continue</button>
        </div>
      </form>
    </div>
  </div>

  <script>
    /* ---------- Data: books ---------- */
    const BOOKS = [
      { title:"The Seven Spiritual Laws of Success", author:"Deepak Chopra", category:"Spirituality", price:100, img:"45.jpeg" },
      { title:"Falling into Grace", author:"Adyashanti", category:"Spirituality", price:150, img:"44.jpeg" },
      { title:"Rich Dad Poor Dad", author:"Robert Kiyosaki", category:"Finance", price:200, img:"43.jpeg" },
      { title:"The Intelligent Investor", author:"Benjamin Graham", category:"Finance", price:250, img:"42.jpeg" },
      { title:"Valuation: Measuring and Managing the Value of Companies", author:"Tim Koller", category:"Finance", price:300,img:"41.jpeg" },
      { title:"The Psychology of Money", author:"Morgan Housel", category:"Finance", price:350, img:"40.jpeg" },
      { title:"Feeding Ghosts:A Graphic Memoir", author:"Tessa Hulls", category:"Memoir", price:400, img:"39.jpeg" },
      { title:"Knife:Meditations After an Attempted Murder", author:"Salman Rushdie", category:"Memoir", price:450, img:"38.jpeg" },
      { title:"Patriot", author:"Alexei Navalny", category:"Memoir", price:500, img:"37.jpeg" },
      { title:"Home of the Happy", author:"LaHaye Fontenot", category:"Memoir", price:550, img:"36.jpeg" },
      { title:"Shoe Dog:A Memoir by the Creator of Nike", author:"Phil Knight", category:"Memoir", price:600, img:"35.jpeg" },
      { title:"Getting Things Done", author:"David Allen", category:"Productivity", price:650, img:"34.jpeg" },
      { title:"Atomic Habits", author:"James Clear", category:"Productivity", price:700, img:"33.jpeg" },
      { title:"The ONE Thing", author:"Gary Keller & Jay Papasan", category:"Productivity", price:750, img:"32.jpeg" },
      { title:"Hyperfocus", author:"Chris Bailey", category:"Productivity", price:800, img:"31.jpeg" },
      { title:"The Bullet Journal Method", author:"Ryder Carroll", category:"Productivity", price:850, img:"30.jpeg"},
      { title:"High Output Management", author:"Andrew Grove", category:"Productivity", price:110, img:"29.jpeg" },
      { title:"Being You:A New Science of Consciousness", author:"Anil Seth", category:"Psychology", price:210, img:"28.jpeg" },
      { title:"Know Thyself:The Science of Self-Awareness", author:"Stephen Fleming", category:"Psychology", price:310, img:"27.jpeg" },
      { title:"Sick Souls,Healthy Minds:How William James Can Save Your Life", author:"John Kaag", category:"Psychology", price:410, img:"26.jpeg" },
      { title:"Awaken the Giant Within", author:"Tony Robbins", category:"Motivation", price:100, img:"25.jpeg" },
      { title:"The Psychology of Money", author:"Morgan Housel", category:"Motivation", price:150, img:"24.jpeg" },
      { title:"The Mindful High Performer", author:"Chelsea Pottinger", category:"Motivation", price:200, img:"23.jpeg" },
      { title:"Rooms For Vanishing", author:"Stuart Nadler", category:"Fiction", price:250, img:"22.jpeg" },
      { title:"The Woman", author:"Kristin Hannah", category:"Fiction", price:300,img:"21.jpeg" },
      { title:"Good Girl", author:"Aria Aber", category:"Fiction", price:350, img:"20.jpeg" },
      { title:"Vantage Point", author:"Sara Sligar", category:"Fiction", price:400, img:"19.jpeg" },
      { title:"Buckeye:A Novel", author:"Patrick Ryan", category:"Fiction", price:450, img:"18.jpeg" },
      { title:"Reality+: Virtual Worlds and the Problems of Philosophy", author:"David Chalmers", category:"Philosophy", price:500, img:"17.jpeg" },
      { title:"Aristotle:Understanding the World's Greatest Philosopher", author:"John Sellars", category:"Philosophy", price:550, img:"16.jpeg" },
      { title:"How to Think Like a Roman Emperor", author:"Donald Robertson", category:"Philosophy", price:600, img:"15.jpeg" },
      { title:"The Philosopher Queens", author:"Rebecca Buxton & Lisa Whiting", category:"Philosophy", price:650, img:"14.jpeg" },
      { title:"Republic", author:"Plato", category:"Philosophy", price:700, img:"13.jpeg" },
      { title:"The Corporation in the Twenty-First Century", author:"John Kay", category:"Business", price:750, img:"12.jpeg" },
      { title:"Build the Damn Thing", author:"Kathryn Finney", category:"Business", price:800, img:"11.jpeg" },
      { title:"This is Strategy:Make Better Plans", author:"Seth Godin", category:"Business", price:850, img:"10.jpeg" },
      { title:"Competing in the Age of AI", author:"Marco Iansiti & Karim R.Lakhani", category:"Business", price:110, img:"9.jpeg" },
      { title:"Abundance", author:"Ezra Klein & Derek Thompson", category:"Business", price:210, img:"8.jpeg" },
      { title:"Playing to Win", author:"A.G.Lafley & Roger L.Martin", category:"Business", price:310, img:"7.jpeg" },
      { title:"Blue Ocean Strategy", author:"W.Chan Kim & Renee Mauborgne", category:"Business", price:410, img:"6.jpeg" },

    ];


    /* ---------- State ---------- */
    let state = {
      books: BOOKS.slice(),
      filter: 'All',
      query: '',
      user: null,
      cartItem: null
    };

    /* ---------- Utilities ---------- */
    function $(sel){return document.querySelector(sel)}
    function $all(sel){return Array.from(document.querySelectorAll(sel))}

    /* ---------- Initialize ---------- */
    document.addEventListener('DOMContentLoaded', ()=>{
      $('#year').textContent = new Date().getFullYear();
      setupNav();
      buildCategoryList();
      renderBooks();
      setupLogin();
      setupSearch();
      setupSort();
      setupPages();
      setupAccount();
      setupPayment();
      setupContact();
    });

    /* ---------- Navigation & pages ---------- */
    function setupNav(){
      $all('[data-nav]').forEach(btn=>{
        btn.addEventListener('click', ()=> showPage(btn.dataset.nav));
      });
      $('#loginBtn').addEventListener('click', ()=> openLoginModal());
      $('#logoutBtn').addEventListener('click', ()=> logout());
    }

    function showPage(name){
      $all('.page').forEach(p=> p.classList.remove('active'));
      const target = $('#'+name);
      if(target) target.classList.add('active');
      // update nav highlight (optional)
      window.scrollTo({top:0, behavior:'smooth'});
      // if switching to payment ensure summary updated
      if(name==='payment') updateSummary();
    }

    /* ---------- Categories ---------- */
    function buildCategoryList(){
      const cats = ['All', ...new Set(BOOKS.map(b=>b.category))];
      const container = $('#categoryList');
      container.innerHTML = '';
      cats.forEach(c=>{
        const btn = document.createElement('button');
        btn.className='category-btn'+(c==='All'?' active':'');
        btn.textContent = c;
        btn.addEventListener('click', ()=>{
          $all('.category-btn').forEach(b=>b.classList.remove('active'));
          btn.classList.add('active');
          state.filter = c;
          renderBooks();
        });
        container.appendChild(btn);
      });
    }

    /* ---------- Render books ---------- */
    function renderBooks(){
      const grid = $('#booksGrid');
      const q = state.query.trim().toLowerCase();
      let list = BOOKS.filter(b=>{
        const matchCat = (state.filter==='All') || b.category === state.filter;
        const matchQuery = !q || b.title.toLowerCase().includes(q) || b.author.toLowerCase().includes(q);
        return matchCat && matchQuery;
      });

      // sort
      const sortBy = $('#sortSelect').value;
      list.sort((a,b)=> a[sortBy].localeCompare(b[sortBy]));

      grid.innerHTML = '';
      list.forEach(book=>{
        const card = document.createElement('article');
        card.className='card';
        card.innerHTML = `
          <div class="cover" aria-hidden><img loading="lazy" src="${book.img}" alt="${escapeHtml(book.title)} cover"></div>
          <div class="meta">
            <h3 class="title">${escapeHtml(book.title)}</h3>
            <div class="author">${escapeHtml(book.author)}</div>
            <div class="tags"><span class="tag">${escapeHtml(book.category)}</span><span class="tag">₹${book.price.toFixed(2)}</span></div>
            <div class="card-actions">
              <button class="btn ghost" data-action="details">Details</button>
              <button class="btn buy" data-action="buy">Buy</button>
            </div>
          </div>
        `;
        grid.appendChild(card);

        // actions
        card.querySelector('[data-action="details"]').addEventListener('click', ()=>{
          showDetails(book);
        });
        card.querySelector('[data-action="buy"]').addEventListener('click', ()=>{
          state.cartItem = book;
          $('#paymentItem').value = `${book.title} — ₹${book.price.toFixed(2)}`;
          $('#cardAmt').value = book.price.toFixed(2);
          updateSummary();
          showPage('payment');
          // smooth scroll
          window.scrollTo({top:0, behavior:'smooth'});
        });
      });

      $('#resultsInfo').textContent = `Showing ${list.length} of ${BOOKS.length} books`;
    }

    function showDetails(book){
      // simple modal-like details via alert for brevity (could be richer)
      const txt = `${book.title}\nBy ${book.author}\nCategory: ${book.category}\nPrice: ₹${book.price.toFixed(2)}\n\nClick OK to go to payment.`;
      if(confirm(txt)){
        state.cartItem = book;
        // Corrected the typo from $mm to $
        $('#paymentItem').value = `${book.title} — ₹${book.price.toFixed(2)}`;
        $('#cardAmt').value = book.price.toFixed(2);
        updateSummary();
        showPage('payment');
      }
    }

    /* ---------- Search & sort ---------- */
    function setupSearch(){
      $('#searchInput').addEventListener('input', e=>{
        state.query = e.target.value;
        renderBooks();
      });
      $('#clearSearch').addEventListener('click', ()=>{
        $('#searchInput').value = '';
        state.query = '';
        renderBooks();
      });
    }
    function setupSort(){
      $('#sortSelect').addEventListener('change', ()=> renderBooks());
    }

    /* ---------- Login ( localStorage) ---------- */
    function setupLogin(){
      // load user
      const saved = localStorage.getItem('reads_user');
      if(saved){
        try{ state.user = JSON.parse(saved) }catch(e){ state.user = null }
      }
      updateUIForUser();

      $('#loginForm').addEventListener('submit', e=>{
        e.preventDefault();
        const name = $('#loginName').value.trim();
        const email = $('#loginEmail').value.trim();
        if(!name || !email){ alert('Please fill name and email'); return; }
        state.user = { name, email, created: new Date().toISOString(), purchases: [] };
        localStorage.setItem('reads_user', JSON.stringify(state.user));
        closeLoginModal();
        updateUIForUser();
        alert('Welcome, ' + name + '! ( account created locally)');
      });

      $('#loginCancel').addEventListener('click', closeLoginModal);
    }

    function openLoginModal(){
      $('#loginModal').classList.add('open');
      $('#loginName').focus();
    }
    function closeLoginModal(){
      $('#loginModal').classList.remove('open');
      $('#loginForm').reset();
    }

    function logout(){
      if(!state.user){ alert('You are not logged in.'); return; }
      if(!confirm('Logout from Reads Hub?')) return;
      localStorage.removeItem('reads_user');
      state.user = null;
      updateUIForUser();
      showPage('home');
    }

    function updateUIForUser(){
      if(state.user){
        $('#loginBtn').textContent = 'Logged in';
        $('#loginBtn').classList.remove('primary');
        $('#accName').textContent = state.user.name;
        $('#accEmail').textContent = state.user.email;
        $('#profileName').value = state.user.name;
        $('#profileEmail').value = state.user.email;
        renderLibrary();
      } else {
        $('#loginBtn').textContent = 'Login / Signup';
        $('#loginBtn').classList.add('primary');
        $('#accName').textContent = 'Guest';
        $('#accEmail').textContent = 'Not logged in';
        $('#profileName').value = '';
        $('#profileEmail').value = '';
        $('#myLibraryList').textContent = 'No purchases yet.';
      }
    }

    /* ---------- Account form ---------- */
    function setupAccount(){
      $('#profileForm').addEventListener('submit', e=>{
        e.preventDefault();
        if(!state.user){ alert('Please login first.'); return; }
        state.user.name = $('#profileName').value.trim() || state.user.name;
        state.user.email = $('#profileEmail').value.trim() || state.user.email;
        localStorage.setItem('reads_user', JSON.stringify(state.user));
        updateUIForUser();
        alert('Profile updated.');
      });

      $('#editProfileBtn').addEventListener('click', ()=>{
        if(!state.user){ alert('Please login first.'); return; }
        showPage('account');
        window.scrollTo({top:0, behavior:'smooth'});
      });
    }

    function renderLibrary(){
      const listEl = $('#myLibraryList');
      if(!state.user || !state.user.purchases || state.user.purchases.length===0){
        listEl.textContent = 'No purchases yet.';
        return;
      }
      listEl.innerHTML = '';
      state.user.purchases.forEach((p, idx)=>{
        const d = document.createElement('div');
        d.style.marginBottom='6px';
        d.innerHTML = `${idx+1}. <strong>${escapeHtml(p.title)}</strong> — ₹${p.price.toFixed(2)} <span class="muted">(${new Date(p.date).toLocaleString()})</span>`;
        listEl.appendChild(d);
      });
    }

    /* ---------- Payment (mock) ---------- */
    function setupPayment(){
      $('#payNowBtn').addEventListener('click', ()=>{
        const item = state.cartItem;
        if(!item){ alert('No item selected — pick a book first.'); return; }
        const name = $('#cardName').value.trim();
        const number = $('#cardNumber').value.replace(/\s+/g,'');
        const exp = $('#cardExp').value.trim();
        const cvv = $('#cardCvv').value.trim();
        const amt = parseFloat($('#cardAmt').value) || 0;

        // basic validation 
        if(!name || number.length < 12 || cvv.length < 3){
          $('#paymentMsg').textContent = 'Please enter valid card details ( validation).';
          return;
        }

        $('#payNowBtn').disabled = true;
        $('#paymentMsg').textContent = 'Processing payment... ';
        setTimeout(()=>{
          $('#paymentMsg').textContent = 'Payment successful . Thank you!';
          $('#payNowBtn').disabled = false;

          // record purchase into local user
          const purchase = { title: item.title, price: item.price, date: new Date().toISOString() };
          if(!state.user){
            if(confirm('You are not logged in — create a  account with this name/email?')){
              const namePrompt = prompt('Enter a name for your  account:', 'Reader');
              const emailPrompt = prompt('Enter an email for your  account:', 'reader@example.com');
              state.user = { name: namePrompt || 'Reader', email: emailPrompt || 'reader@example.com', created: new Date().toISOString(), purchases:[purchase] };
              localStorage.setItem('reads_user', JSON.stringify(state.user));
            } else {
              // store receipt in localStorage as guest purchases
              const guest = JSON.parse(localStorage.getItem('reads_guest_purchases') || '[]');
              guest.push(purchase);
              localStorage.setItem('reads_guest_purchases', JSON.stringify(guest));
            }
          } else {
            state.user.purchases = state.user.purchases || [];
            state.user.purchases.push(purchase);
            localStorage.setItem('reads_user', JSON.stringify(state.user));
          }
          renderLibrary();
          updateSummary();
        }, 1200);
      });
    }

    function updateSummary(){
      const item = state.cartItem;
      if(item){
        $('#summaryItem').textContent = item.title;
        $('#summaryPrice').textContent = `₹${item.price.toFixed(2)}`;
        $('#summaryTotal').textContent = `₹${item.price.toFixed(2)}`;
        $('#paymentItem').value = `${item.title} — ₹${item.price.toFixed(2)}`;
        $('#cardAmt').value = item.price.toFixed(2);
      } else {
        $('#summaryItem').textContent = '—';
        $('#summaryPrice').textContent = `₹0.00`;
        $('#summaryTotal').textContent = `₹0.00`;
      }
    }

    /* ---------- Contact ---------- */
    function setupContact(){
      $('#contactForm').addEventListener('submit', e=>{
        e.preventDefault();
        const name = $('#contactName').value.trim();
        const email = $('#contactEmail').value.trim();
        const msg = $('#contactMessage').value.trim();
        if(!name || !email || !msg){ $('#contactMsg').textContent = 'Please fill all fields.'; return; }
        $('#contactMsg').textContent = 'Message sent. We will reply to ' + email + ' (this is a project).';
        $('#contactForm').reset();
      });
    }

    /* ---------- Pages (keyboard close modal) ---------- */
    function setupPages(){
      // close modal on ESC
      document.addEventListener('keydown', e=>{
        if(e.key === 'Escape') closeLoginModal();
      });
      // close modal click outside
      $('#loginModal').addEventListener('click', (e)=>{
        if(e.target === $('#loginModal')) closeLoginModal();
      });
    }

    /* ---------- Helpers ---------- */
    function escapeHtml(s){
      return String(s).replace(/[&<>"']/g, function(m){ return ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m]) });
    }

  </script>
</body>
</html>
